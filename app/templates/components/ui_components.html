{#
    Consolidated UI Components Library

    This file contains reusable UI components for:
    - Icons (SVG)
    - Buttons
    - Alerts (error, success, warning)
    - Form inputs

    Usage:
    {% from "components/ui_components.html" import icon_pill, back_button, error_alert, form_input %}
#}

{# =============================================
     ICONS
============================================= #}

{% macro icon_pill(class="w-7 h-7", color="text-accent") %}
<svg class="{{ class }} {{ color }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
{% endmacro %}

{% macro icon_droplet(class="w-7 h-7", color="text-accent") %}
<svg class="{{ class }} {{ color }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z">
    </path>
</svg>
{% endmacro %}

{% macro icon_activity(class="w-7 h-7", color="text-accent") %}
<svg class="{{ class }} {{ color }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
    </path>
</svg>
{% endmacro %}

{% macro icon_document(class="w-7 h-7", color="text-accent") %}
<svg class="{{ class }} {{ color }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
    </path>
</svg>
{% endmacro %}

{% macro icon_back(class="w-4 h-4") %}
<svg class="{{ class }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
</svg>
{% endmacro %}

{% macro icon_arrow_right(class="w-4 h-4") %}
<svg class="{{ class }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
</svg>
{% endmacro %}

{# =============================================
     BUTTONS
============================================= #}

{% macro back_button(url, text="Voltar") %}
<a href="{{ url }}" class="inline-flex items-center gap-2 py-2 text-slate-600 hover:text-slate-800 transition-colors">
    {{ icon_back() }}
    {{ text }}
</a>
{% endmacro %}

{# =============================================
     ALERTS
============================================= #}

{% macro error_alert(errors, title="Erro") %}
{% if errors %}
<div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
    <h3 class="font-semibold text-red-800 mb-2">{{ title }}:</h3>
    {% if errors is string %}
    <p class="text-sm text-red-700">{{ errors }}</p>
    {% else %}
    <ul class="list-disc list-inside text-red-700 text-sm">
        {% for error in errors %}
        <li>{{ error }}</li>
        {% endfor %}
    </ul>
    {% endif %}
</div>
{% endif %}
{% endmacro %}

{% macro success_alert(message) %}
{% if message %}
<div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
    <p class="text-sm text-green-700">{{ message }}</p>
</div>
{% endif %}
{% endmacro %}

{% macro warning_alert(message) %}
{% if message %}
<div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg">
    <p class="text-sm text-amber-700">{{ message }}</p>
</div>
{% endif %}
{% endmacro %}

{# =============================================
     FORM INPUTS
============================================= #}

{% macro form_input(label, name, input_type="text", required=false, placeholder="", autocomplete="", value="", hint=None) %}
<div>
    <label for="{{ name }}" class="block text-sm font-medium text-slate-700 mb-2">
        {{ label }}
        {% if required %}<span class="text-red-500">*</span>{% endif %}
    </label>
    <input
        type="{{ input_type }}"
        id="{{ name }}"
        name="{{ name }}"
        {% if required %}required{% endif %}
        {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
        {% if autocomplete %}autocomplete="{{ autocomplete }}"{% endif %}
        {% if value %}value="{{ value }}"{% endif %}
        class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all">
    {% if hint %}
    <p class="mt-2 text-xs text-slate-500">{{ hint }}</p>
    {% endif %}
</div>
{% endmacro %}

{# =============================================
     PAGE HEADER
============================================= #}

{% macro page_header(title, subtitle=None, back_url=None, back_text="Voltar", action_url=None, action_text=None, action_icon=None, action_loading=False) %}
{% if back_url %}
<div class="mb-4">
    {{ back_button(back_url, back_text) }}
</div>
{% endif %}
<div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4 sm:mb-8">
    <div>
        <h1 class="font-heading text-2xl sm:text-3xl font-bold text-primary">
            {{ title }}
        </h1>
        {% if subtitle %}
        <p class="text-slate-600 mt-1">{{ subtitle }}</p>
        {% endif %}
    </div>
    {% if action_url and action_text %}
    <a href="{{ action_url }}"
        class="inline-flex items-center justify-center gap-2 w-full sm:w-auto bg-accent hover:bg-accent-hover text-white py-2 px-4 rounded-lg font-medium transition-colors"
        {% if action_loading %}data-action-link data-loading-text="Exportando..."{% endif %}>
        {% if action_icon == "plus" %}
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        {% elif action_icon == "download" %}
        <svg class="w-4 h-4" data-link-icon fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
        </svg>
        {% endif %}
        <span data-link-text>{{ action_text }}</span>
        <span data-link-spinner class="hidden">{{ spinner(size="sm", color="white") }}</span>
    </a>
    {% endif %}
    {{ caller() if caller else '' }}
</div>
{% endmacro %}

{# =============================================
     EMPTY STATE
============================================= #}

{% macro empty_state(message, card=False, icon=None, title=None, padding="py-4") %}
{% if card %}
<div class="bg-white rounded-2xl shadow-lg border border-slate-100 p-6 sm:p-12 text-center">
    {% if icon %}
    <div class="w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6">
        {% if icon == "document" %}
        <svg class="w-10 h-10 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        {% endif %}
    </div>
    {% endif %}
    {% if title %}
    <h2 class="font-heading text-xl font-bold text-primary mb-2">{{ title }}</h2>
    {% endif %}
    <p class="text-slate-600 max-w-md mx-auto">{{ message }}</p>
</div>
{% else %}
<p class="text-sm text-slate-500 text-center {{ padding }}">{{ message }}</p>
{% endif %}
{% endmacro %}

{# =============================================
     CALLOUT BOX
============================================= #}

{% macro callout(content=None, color="blue", title=None, margin="mt-4") %}
{% set border_color = "border-accent" if color == "accent" else "border-" ~ color ~ "-500" %}
{% set bg_color = "bg-" ~ color ~ "-50" %}
{% set text_color = "text-" ~ color ~ "-900" if color != "accent" else "text-blue-900" %}
<div class="{{ bg_color }} border-l-4 {{ border_color }} p-4 {{ margin }}">
    {% if title %}
    <p class="text-sm {{ text_color }}">
        <strong>{{ title }}:</strong> {% if content %}{{ content|safe }}{% endif %}
    </p>
    {% elif content %}
    <p class="text-sm {{ text_color }}">{{ content|safe }}</p>
    {% endif %}
    {{ caller() if caller else '' }}
</div>
{% endmacro %}

{# =============================================
     SPINNER
============================================= #}

{% macro spinner(size="md", color="accent", container=False) %}
{% set size_classes = {
    "sm": "w-4 h-4 border-2",
    "md": "w-8 h-8 border-4",
    "lg": "w-10 h-10 border-4"
} %}
{% set color_classes = {
    "accent": "border-accent border-t-transparent",
    "white": "border-white border-t-transparent",
    "blue": "border-blue-600 border-t-transparent",
    "slate": "border-slate-400 border-t-transparent"
} %}
{% if container %}
<div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center">
    <div class="animate-spin {{ size_classes.lg }} {{ color_classes.get(color, color_classes.accent) }} rounded-full"></div>
</div>
{% else %}
<div class="animate-spin {{ size_classes.get(size, size_classes.md) }} {{ color_classes.get(color, color_classes.accent) }} rounded-full{% if size == 'sm' %} inline-block{% endif %}"></div>
{% endif %}
{% endmacro %}
